python:
  - "2.7"

env:
  - LUA="luajit"

install:
  - sudo pip install autobahntestsuite
  - sudo apt-get install libev-dev
  - sudo apt-get install lua5.1 liblua5.1-0-dev
  - wget http://luarocks.org/releases/luarocks-2.2.1.tar.gz
  - tar zxpf luarocks-2.2.1.tar.gz
  - cd luarocks-2.2.1
  - ./configure; sudo make bootstrap
  - cd ..
  - git clone http://github.com/lipp/busted
  - cd busted
  - git checkout 1.11.1-uvll-support
  - ./try
  - cd ..
  - sudo luarocks install luacov-coveralls

script: "sudo luarocks make rockspecs/lua-websockets-scm-1.rockspec && ./test.sh"

after_success:
  - luacov-coveralls
